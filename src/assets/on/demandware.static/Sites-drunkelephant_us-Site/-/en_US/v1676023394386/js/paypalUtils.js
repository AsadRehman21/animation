'use strict';(function(){var isDebugMode=true;var paypalUtils={};if(console&&isDebugMode){var consoleLog=console.log;var consoleError=console.error;console.log=function(){consoleLog.apply(console,arguments);};console.error=function(){consoleError.apply(console,arguments);};}else{console={log:function(){},error:function(){}};}
paypalUtils.console=console;paypalUtils.initButton=function(params,buttonEl){var config=params;if(isDebugMode){if(typeof config.env!=='string'){console.error('paypalUtils: env is mandatory parameter. The value can be "production" or "sandbox"');return;}
if(!(config.env==='production'||config.env==='sandbox')){console.error('paypalUtils: The value of env parameter must be "production" or "sandbox"');return;}
if(config.bmConfigurationInvalid){console.error('Invalid configuration in BM: Merchant Tools > Site Preferences > Custom Preference > Paypal_Express_Checkout > Field: '+config.bmConfigurationInvalid);return;}}
var createPaymentUrl=config.createPaymentUrl;delete config.createPaymentUrl;var createPaymentErrorHandle=config.createPaymentErrorHandle||function(error){if(error==='empty_cart'){window.location.reload();}else{var url=window.location.href;url+=url.indexOf('?')>-1?'&':'?';window.location.href=url+'showPaypalError=true';}};delete config.createPaymentErrorHandle;var defaultButtonConfig={locale:'en_US',style:{layout:'vertical',size:'responsive',shape:'pill',color:'gold'},funding:{allowed:[],disallowed:[]},payment:function(resolve,reject){window.dataLayer.push({event:'eeCheckoutOption',checkoutStep:'1',checkoutOption:'Paypal'});console.log('paypalUtils: payment','payment url:',createPaymentUrl);$.post(createPaymentUrl,{isGift:sessionStorage.getItem('isGift'),giftMessage:sessionStorage.getItem('giftMessage')},function(data){console.log('paypalUtils: Getting token data response',data);if(data.error){createPaymentErrorHandle(data.error);console.error('paypalUtils: '+createPaymentUrl+' returned data with error');reject(data.error);}
if(!data.token){console.error('paypalUtils: data does not have token property');reject('system_error');return;}
resolve(data.token);});},onAuthorize:function(data,actions){console.log('paypalUtils: onAuthorize.data',data);return actions.redirect();},onCancel:function(data,actions){console.log('paypalUtils: onCancel.data',data);},onError:function(msg){console.log('paypalUtils: onError.msg',msg);}};config=$.extend(defaultButtonConfig,config);console.log('paypalUtils: paypal.Button.render config',config);paypal.Button.render(config,buttonEl);};paypalUtils.initFraudnet=function(){var scriptBaseURL='https://www.paypalobjects.com/webstatic/r/fb/';var dom;var doc;var where;var iframe=document.createElement('iframe');iframe.src='about:blank';iframe.title='';iframe.role='presentation';(iframe.frameElement||iframe).style.cssText='width: 0; height: 0; border: 0';where=document.getElementsByTagName('script');where=where[where.length-1];where.parentNode.insertBefore(iframe,where);try{doc=iframe.contentWindow.document;}catch(e){dom=document.domain;iframe.src="javascript:var d=document.open();d.domain='"+dom+"';void(0);";doc=iframe.contentWindow.document;}
doc.open()._l=function(){var js=this.createElement('script');if(dom){this.domain=dom;}
js.id='js-iframe-async';js.src=scriptBaseURL+'fb-all-prod.pp.min.js';this.body.appendChild(js);};doc.write('<body onload="document._l();">');doc.close();};window.paypalUtils=paypalUtils;}());